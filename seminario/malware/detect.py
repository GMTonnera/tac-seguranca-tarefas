import psutil

# Processos confiáveis da rede - whitelist
white_list = [

]

def detect_suspect_processes():
    processos_suspeitos = []

    for proc in psutil.process_iter(['pid', 'name']):
        try:
            process_name = proc.info['name']
            exec_path = proc.exe()  # Pegamos caminho do executavel

            if process_name not in white_list:
                processos_suspeitos.append({
                    'pid': proc.pid,
                    'name': process_name,
                    'exe_path': exec_path
                })
        except (psutil.NoSuchProcess, psutil.AccessDenied, psutil.ZombieProcess):
            continue

    return processos_suspeitos

def main():
    suspect_processes = detect_suspect_processes()
    if suspect_processes:
        print("Processos suspeitos detectados:")
        for p in suspect_processes:
            print(f"PID: {p['pid']}, Nome: {p['name']}")
            print(f"     Caminho do executável: {p['exe_path']}")
    else:
        print("Nenhum processo suspeito encontrado.")

if __name__ == "__main__":
    main()