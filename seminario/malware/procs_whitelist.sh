#!/bin/bash

> white_list.txt

for pid in $(ls /proc | grep -E '^[0-9]+$'); do
    if [ -r "/proc/$pid/exe" ]; then
        exe=$(readlink -f "/proc/$pid/exe" 2>/dev/null)
        if [ -n "$exe" ]; then
            echo "$exe" >> white_list.txt
            continue
        fi
    fi

    if [ -r "/proc/$pid/comm" ]; then
        comm=$(cat /proc/$pid/comm 2>/dev/null)
        if [ -n "$comm" ]; then
            echo "$comm" >> white_list.txt
        fi
    fi
done

sort -u white_list.txt -o white_list.txt
